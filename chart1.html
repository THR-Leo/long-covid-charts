<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Graph 1</title>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+3:wght@400;600;700&display=swap" rel="stylesheet">

    <script src="https://www.gstatic.com/charts/loader.js"></script>

    <style>
      :root { --chart-left: 140px; }

      html, body { margin: 0; padding: 0; }
      body { font-family: "Source Sans 3", system-ui, -apple-system, Segoe UI, Arial, sans-serif; }

      .wrap { width: 100%; }

      /* Let the chart fill the iframe width */
      #chart1 { width: 100%; }

      .caption {
        margin: 10px 0 0;
        padding-left: var(--chart-left);
        padding-right: 16px;
        text-align: left;
        font-size: 14px;
        color: #333;
      }
    </style>

    <script>
      google.charts.load('current', { packages: ['corechart'] });
      google.charts.setOnLoadCallback(draw);

      function computeLeftPadding(containerWidth) {
        // Responsive left padding: enough for labels, but not wasteful on narrow columns.
        return Math.max(110, Math.min(160, Math.round(containerWidth * 0.22)));
      }

      function draw() {
        const el = document.getElementById('chart1');
        const w = el.parentElement.clientWidth || 800;
        const left = computeLeftPadding(w);

        // Keep caption aligned with the chart area automatically
        document.documentElement.style.setProperty('--chart-left', left + 'px');

        const data = google.visualization.arrayToDataTable([
          ['Group', 'Percent', { role: 'annotation' }],
          ['Trans People', 46, '46%'],
          ['Other', 37, '37%'],
          ['Cis Women', 32, '32%'],
          ['Cis Men', 22, '22%']
        ]);

        const options = {
          title: 'Which genders are most likely to develop long COVID?',
          titleTextStyle: { fontName: 'Source Sans 3', fontSize: 22, bold: true },

          height: 460,                 // tighter than before
          legend: { position: 'none' },

          hAxis: {
            minValue: 0,
            maxValue: 50,
            ticks: [0, 10, 20, 30, 40, 50],
            textStyle: { fontName: 'Source Sans 3', fontSize: 14 }
          },
          vAxis: { textStyle: { fontName: 'Source Sans 3', fontSize: 18 } },

          annotations: {
            alwaysOutside: true,
            textStyle: { fontName: 'Source Sans 3', fontSize: 16, color: '#000' }
          },

          bar: { groupWidth: '72%' },
          colors: ['#000F46'],

          chartArea: {
            left: left,
            right: 24,
            top: 78,
            bottom: 48
          },

          backgroundColor: 'transparent'
        };

        new google.visualization.BarChart(el).draw(data, options);
      }

      // Redraw on resize (important inside iframes)
      window.addEventListener('resize', () => {
        if (window.google && google.visualization) draw();
      });
    </script>
  </head>

  <body>
    <div class="wrap">
      <div id="chart1"></div>
      <div class="caption">Long COVID symptom severity, by gender, December 2022</div>
    </div>
  </body>
</html>
